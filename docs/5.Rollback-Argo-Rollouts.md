# Argo Rollouts: Rollback

## 🎯 Overview

A **Rollback** in Argo Rollouts lets you revert an application to a previous stable version when a new rollout causes failures, instability, or degraded performance.  
It can be triggered **via CLI** or **Argo Rollouts UI**, ensuring minimal downtime and safe recovery to the last known good revision.

---

## 🔁 Rollback via CLI

### 🧩 1. Identify Current and Previous Revisions

List rollout history to find available revisions:
```bash
kubectl argo rollouts history rollout rollouts-demo
```

Expected Output:
```
REVISION  CHANGE-CAUSE                     STATUS     AGE
1         Initial release (blue)           Healthy    2h
2         Updated to green                 Degraded   5m
```

---

### 🧩 2. Rollback to Previous Revision

Use the `undo` command to revert:
```bash
kubectl argo rollouts undo rollout rollouts-demo --to-revision=1
```

If you omit the `--to-revision` flag, Argo Rollouts automatically rolls back to the previous stable revision.

Expected Output:
```
rollout 'rollouts-demo' undone
```

Check the status:
```bash
kubectl argo rollouts get rollout rollouts-demo --watch
```

Example:
```
Name:            rollouts-demo
Namespace:       default
Status:          ✔ Healthy
Strategy:        Canary
  Step:          12/12
  SetWeight:     100
  ActualWeight:  100
Images:          argoproj/rollouts-demo:blue (stable)
Replicas:
  Desired:       5
  Current:       5
  Updated:       5
  Ready:         5
  Available:     5

NAME                                       KIND        STATUS     AGE  INFO
⟳ rollouts-demo                            Rollout     ✔ Healthy  3m
└──# revision:1
   └──⧉ rollouts-demo-687d76d795           ReplicaSet  ✔ Healthy  3m   stable
      ├──□ rollouts-demo-687d76d795-2dsmc  Pod         ✔ Running  3m   ready:1/1
      ├──□ rollouts-demo-687d76d795-2mpr6  Pod         ✔ Running  3m   ready:1/1
      ├──□ rollouts-demo-687d76d795-7tdwl  Pod         ✔ Running  3m   ready:1/1
      ├──□ rollouts-demo-687d76d795-dxjjh  Pod         ✔ Running  3m   ready:1/1
      └──□ rollouts-demo-687d76d795-p6dbb  Pod         ✔ Running  3m   ready:1/1
```

---

## 🌐 Rollback via UI

1. Go to [Argo Rollouts UI](http://argorollouts.apsis.localnet).  
2. Select your rollout (e.g., `rollouts-demo`).  
3. Click **Actions (⋮)** ➜ **Rollback**.  
4. Choose the previous stable revision from the list.  
5. Confirm to start the rollback process.

Example screenshots:  
![Rollback button](https://github.com/user-attachments/assets/rollback-btn.png)  
![Rollback confirmation](https://github.com/user-attachments/assets/rollback-confirm.png)

---

## ⚙️ Practical Example – Rollback from Green → Blue

You deployed a new version:
```bash
kubectl argo rollouts set image rollouts-demo rollouts-demo=argoproj/rollouts-demo:green
```

But the deployment fails during health checks.  
Rollback to the previous stable (blue) version:
```bash
kubectl argo rollouts undo rollout rollouts-demo
```

Check active image:
```bash
kubectl describe rollout rollouts-demo | grep Image
```

Expected Output:
```
Image: argoproj/rollouts-demo:blue
```

✅ Rollback successful — your application is now restored to the last stable version.

---

## 🧠 Verification Steps

1. Monitor rollout:
   ```bash
   kubectl argo rollouts get rollout rollouts-demo --watch
   ```
2. Confirm image:
   ```bash
   kubectl describe rollout rollouts-demo | grep Image
   ```
3. Check pod status:
   ```bash
   kubectl get pods -l app=rollouts-demo -o wide
   ```
4. Validate app availability in browser:
   - [http://demorollouts.apsis.localnet](http://demorollouts.apsis.localnet)

---

## 🧾 Summary Table

| Action | CLI Command | Description | UI Equivalent |
|--------|--------------|-------------|----------------|
| 🔁 Rollback | `kubectl argo rollouts undo rollout <name> --to-revision=<n>` | Revert to previous stable version | Actions → Rollback |
| 🔍 Verify | `kubectl argo rollouts get rollout <name>` | Check rollback progress | Rollout details page |
| 📊 History | `kubectl argo rollouts history <name>` | View all revisions | History tab |

---

Next: []()  
Prev: []()  

*Author: Jamal Hossain*  
*Date: 2025-10-12*
